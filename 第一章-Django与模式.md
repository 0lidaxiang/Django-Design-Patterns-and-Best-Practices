
第一章 Django和模式
------------------   

在这一章，我们谈及以下话题： 

	 我们为什么选择Django？
	 Django是工作原理
	 什么是模式？
	 常见的模式合集
	 Django中的模式
	

我们为什么选择Django？  

每个web应用都不尽相同，就像一件手工制作的家具一样。你几乎会很少发现大批量的生成能够完美地达到你的需求。即使你从一个基本需求开始，比如一个博客或者一个社交网络，你都需要缓慢地开发，

这就是类似Django或者Rails的web框架非常流行的原因。框架加速了开发，而且它带有很多练好的经过实践的内容。

Python可能比其他流行的编程语言具有更多的web框架。

开箱即用的admin接口，它是Django才有的独一无二的特点，早些时候，特别是在数据记录和测试方面它大有裨益。而Django的开发文档作为一个出色的开源项目早已是备受赞誉。

最后，Django在多个高流量的网站中历经实战的考验。它对于常见的攻击比如跨站脚本和跨站请求攻击有着异常敏锐观察。

尽管，在理论上，可能对于所有类型的网站Django不是最佳选择，你可以是使用Django构建任何类型的网站。例如，要构建一个基于web聊天的实时接口，或许你要使用Tornado，但是web引用剩下的部分你可以仍旧使用Django来完成。对于开发你要学会选择正确的工具。

某些内建的特性，比如admin接口，如果你使用过其他的web框架或许让你听上去感觉有点怪怪的。为了Django的设计，就让我们找出它是如何问世的。

##Django的历史
略

###一个框架的诞生
略

###移除魔法
略

###Django坚持做得更好
略

###Django是如何工作的？
要真正的欣赏Django，你需要撇开表象来看本质。它启发你同时让你不知所措。如果你已经熟悉它，或许就想要跳过这一节。

下图：在一个典型的Django应用中web请求是如何被处理的。  
![django request](http://ww1.sinaimg.cn/mw1024/6184c0e3gw1ertof4w7ckj20m50d8dhi.jpg)

前面的图片展示了从一个访客的浏览器到Django应用并返回的一个web请求的简单历程。如下是数字标识的路径：

	1. 浏览器发送请求（基本上是字节类型的字符串）到web服务器。
	
	2. web服务器（比如，Nginx）把这个请求转交到一个WSGI（比如，uWSGI），或者直接地文件系统能够取出
	一个文件（比如，一个CSS文件）。
	
	3. 不像web服务器那样，WSGI服务器可以直接运行Python应用。请求生成一个被称为environ的Ptyhon字典，
	而且，可以选择传递过去几个中间件的层，最终，达到Django应用。
	
	4. URLconf中含有属于应用的urls.py选择一个视图处理基于请求的URL的那个请求，这个请求就已经变成了
	HttpRequest——一个Python字典对象。
	
	5. 被选择的那个视图通常要做下面所列出的一件或者更多件事情： 
	
	   通过模型与数据库对话。
	   使用模板渲染HTML或者任何格式化过的响应。
	   返回一个纯文本响应（不被显示的）。
	   抛出一个异常。
	   
	6. HttpResponse对象离开Django后，被渲染为一个字符串。
	
	7. 在浏览器见到一个美化的，渲染后的web页面。
	

虽然某些细节被省略掉，这个解释应该有助于欣赏Django的高级架构。它也展示了关键的组件所扮演的角色，比如模型，视图，和模板。Django的很多组件都基于这几个广为人知设计模式。  

##什么是模式？
略
  
###四人组模式

Django中的模式与此对比： 

|四人组模式		|Django组件		|		解释					|
| ------------- |:-------------:|----------------------:|
|命令模式        |HttpRequest    |把一个request封装进一个对象
|观察者模式		|Signals		|一个对象改变状态时，它的所有侦听器都被通知并自动更新
|模板模式		|基于类的视图		| 一个算法的步骤可以不用改变算法结构来重新定义子类

而这些模式是对于学习Django内部的人来说构造最有趣的，Django下面的模式可以再次分类——这也是个常见的问题。

###Django是MVC吗？
MVC对于模型，视图，和控制该做什么设定的非常严格。然而，到web应用Django采取的是更实用的视图。要处理原生的HTTP协议，每个到web页面的请求独立于其他的请求。Django的框架设计的像一个管道处理每个请求，准备好响应。  

Django称之为模型-模板-视图（MTV）架构。数据库接口类（模型）和 请求处理类（视图），以及最终表现的模板语言之间有着独立关系。  

如果你将它于经典的MVC比较，“模型”可以通Django的模型比较，“视图”  

要是这些都还不足以让你感到迷惑，Django倾向于选择命名回调函数处理每个URL的“视图”函数。即，一个没有MVC视图概念的视图。

###福勒模式
Django中的模式与此对比：  

|四人组模式	  	|Django组件	  	|解释					|
|-------------	|:-------------:|--------------------:	|
|活动记录		|Django模型		|封装数据库访问，对数据添加域名逻辑
|类表继承		|模型继承		|继承中的每个实体都映射到一个独立的表
|标识自动		|Id字段			|在一个对象中保存一个数据库ID字段以维护标识
|模板视图		|Django模板 		|使用HTML的内嵌生成器渲染到HTML


###还有更多的模式？
略  

##本书中模式
本书覆盖针对对于Django开发者会很有用的Django的设计和架构模式。接下来的章节会描述每个模式是如何实现的。

**模式名称**
标题是模式名称。如果它是知名的模式，常用的名字被使用；否则，简洁的，自描述的名称被选择。名称非常重要，它们有助于构建模式词汇。所有的模式都有以下部分：  

###鉴审模式
尽管它们近乎于通用，模式共享也有它们的审鉴共享。它们的最常见参数如下：  
略

###如何使用模式  
略

##最佳实践  
略

###Python之禅和Django的设计哲学  
略  

**提示**
  略

**提示**
*最佳实践*：  
在settings.py中使用BASE_DIR，避免硬编码目录名称。  

##总结  
略
